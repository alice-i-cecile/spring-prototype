<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Space Demo</title>
    <link href="/stylesheets/screen.css" media="all" rel="stylesheet" type="text/css"/>
    <script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript"></script><script language="javascript" src="javascripts/jquery.hotkeys.js" type="text/javascript"></script><script language="javascript" src="javascripts/key_status.js" type="text/javascript"></script><script language="javascript" src="javascripts/util.js" type="text/javascript"></script><script language="javascript" src="javascripts/sprite.js" type="text/javascript"></script><script language="javascript" src="javascripts/sound.js" type="text/javascript"></script>
  </head>
  <body>
    <h1>Space Demo</h1>
    <script type='text/javascript'>
      //<![CDATA[
        var CANVAS_WIDTH = 480;
        var CANVAS_HEIGHT = 320;
        var FPS = 30;

        var player = {
          color: "#00A",
          x: 50,
          y: 270,
          width: 20,
          height: 30,
          draw: function() {
            canvas.fillStyle = this.color;
            canvas.fillRect(this.x, this.y, this.width, this.height);
          }
        };

        var canvasElement = $("<canvas width='" + CANVAS_WIDTH +
          "' height='" + CANVAS_HEIGHT + "'></canvas");
        var canvas = canvasElement.get(0).getContext("2d");
        canvasElement.appendTo('body');

        setInterval(function() {
          update();
          draw();
        }, 1000/FPS);

        function update() {
          if(keydown.left) {
            player.x -= 5;
          }

          if(keydown.right) {
            player.x += 5;
          }

          if(keydown.up) {
            player.y -= 5;
          }

          if(keydown.down) {
            player.y += 5;
          }
          player.x = player.x.clamp(0, CANVAS_WIDTH - player.width);
          player.y = player.y.clamp(0, CANVAS_HEIGHT - player.height);
        }

        function draw() {
          canvas.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
          player.draw();
        }

        player.sprite = Sprite("player");

        player.draw = function() {
          this.sprite.draw(canvas, this.x, this.y);
        };
      //]]>
    </script>
  </body>
</html>
